<!DOCTYPE html>
<html>
<head>
  <title>Hex Packet Decoder</title>
  <style>
    body { font-family: Arial; margin: 20px; }
    textarea { width: 100%; height: 150px; }
    .result { margin-top: 20px; white-space: pre; background: #f0f0f0; padding: 15px; }
  </style>
</head>
<body>

<h2>Hex Packet Decoder</h2>

<textarea id="hexInput" placeholder="Paste hex here..."></textarea>
<br><br>
<button onclick="decode()">Decode Packet</button>

<div class="result" id="result"></div>

<script>
function hexToBytes(hex) {
    hex = hex.replace(/\s+/g, "").toLowerCase();
    let out = [];
    for (let i = 0; i < hex.length; i += 2) {
        out.push(parseInt(hex.substr(i, 2), 16));
    }
    return out;
}

function formatMAC(bytes) {
    return bytes.map(b => b.toString(16).padStart(2, '0')).join(":");
}

function formatIP(bytes) {
    return bytes.join(".");
}

function decode() {
    let hex = document.getElementById("hexInput").value;
    let b = hexToBytes(hex);

    if (b.length < 14) {
        document.getElementById("result").innerText = "Not enough data for Ethernet frame";
        return;
    }

    let dstMAC = formatMAC(b.slice(0,6));
    let srcMAC = formatMAC(b.slice(6,12));
    let etherType = (b[12] << 8 | b[13]).toString(16);

    let output = "";
    output += "=== Ethernet Header ===\n";
    output += "Destination MAC: " + dstMAC + "\n";
    output += "Source MAC: " + srcMAC + "\n";
    output += "EtherType: 0x" + etherType + "\n\n";

    // IPv4
    if (etherType === "800") {
        let version = b[14] >> 4;
        let ihl = b[14] & 0x0F;
        let ttl = b[22];
        let protocol = b[23];
        let srcIP = formatIP(b.slice(26, 30));
        let dstIP = formatIP(b.slice(30, 34));

        output += "=== IPv4 Header ===\n";
        output += "Version: " + version + "\n";
        output += "IHL: " + ihl + "\n";
        output += "TTL: " + ttl + "\n";
        output += "Protocol: " + protocol + "\n";
        output += "Source IP: " + srcIP + "\n";
        output += "Destination IP: " + dstIP + "\n";
    }

    document.getElementById("result").innerText = output;
}
</script>

</body>
</html>
